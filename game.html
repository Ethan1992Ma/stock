<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>貿易利潤判定器</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f9f9f9; }
    h1 { font-size: 20px; }
    table { border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px 12px; text-align: center; }
    th { background: #eee; }
    select { margin: 5px; }
    .result { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>
  <h1>📦 貿易利潤判定器</h1>
  <p>請選擇每個城市的「買入」與「賣出」行情：</p>

  <div id="inputs"></div>

  <button onclick="calculate()">計算最優解</button>

  <div class="result" id="bestResult"></div>

  <h2>完整利潤表</h2>
  <div id="profitTable"></div>

  <script>
    const cities = ["泉州", "幽州", "杭州", "雙王", "十方"];
    const buyOptions = { "基礎": 1, "高價": 1.2 }; // 高價 = 1.2 倍成本
    const sellOptions = {
      "極低": 0.5,
      "基礎": 1.0,
      "略高": 2.0,
      "高價": 3.0,
      "極高": 4.0
    };

    // 參考獲利基準表
    const baseProfit = {
      "泉州": { "杭州": 12000, "幽州": 9000, "雙王": 9000 },
      "幽州": { "十方": 9190, "泉州": 8100 },
      "杭州": { "泉州": 12500, "幽州": 8083, "十方": 7166 },
      "雙王": { "十方": 6097, "幽州": 4609 },
      "十方": { "幽州": 7608, "雙王": 7608, "杭州": 2347 }
    };

    // 建立輸入表單
    const container = document.getElementById("inputs");
    cities.forEach(city => {
      const div = document.createElement("div");
      div.innerHTML = `<b>${city}</b> 買入: 
        <select id="${city}-buy">
          ${Object.keys(buyOptions).map(opt => `<option>${opt}</option>`).join("")}
        </select>
        賣出: 
        <select id="${city}-sell">
          ${Object.keys(sellOptions).map(opt => `<option>${opt}</option>`).join("")}
        </select>`;
      container.appendChild(div);
    });

    function calculate() {
      let results = [];
      let best = { profit: -Infinity, route: "" };

      for (let from of cities) {
        for (let to of cities) {
          if (from === to) continue;
          if (!baseProfit[from] || !baseProfit[from][to]) continue;

          let buyType = document.getElementById(`${from}-buy`).value;
          let sellType = document.getElementById(`${to}-sell`).value;

          let base = baseProfit[from][to];
          let cost = base * buyOptions[buyType];
          let revenue = base * sellOptions[sellType];
          let profit = revenue - cost;

          results.push({ from, to, base, buyType, sellType, profit });

          if (profit > best.profit) {
            best = { profit, route: `${from} → ${to} (${profit})` };
          }
        }
      }

      // 顯示最佳解
      document.getElementById("bestResult").innerText = `最優解：${best.route}`;

      // 顯示完整利潤表
      let html = "<table><tr><th>進貨</th><th>出貨</th><th>基準值</th><th>買入</th><th>賣出</th><th>利潤</th></tr>";
      results.forEach(r => {
        html += `<tr><td>${r.from}</td><td>${r.to}</td><td>${r.base}</td><td>${r.buyType}</td><td>${r.sellType}</td><td>${r.profit}</td></tr>`;
      });
      html += "</table>";
      document.getElementById("profitTable").innerHTML = html;
    }
  </script>
</body>
</html>
