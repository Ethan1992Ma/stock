<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>貿易利潤判定器</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 10px; background: #f9f9f9; margin: 0; }
    h1 { font-size: 18px; text-align: center; }
    p { font-size: 14px; text-align: center; }
    .city-input { display: flex; flex-direction: column; margin: 8px 0; padding: 8px; background: #fff; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .city-input b { margin-bottom: 4px; }
    select { padding: 6px; font-size: 14px; margin: 2px 0; width: 100%; border-radius: 6px; border: 1px solid #ccc; }
    button { width: 100%; padding: 10px; margin-top: 12px; font-size: 16px; background: #007aff; color: white; border: none; border-radius: 8px; cursor: pointer; }
    button:active { background: #005bb5; }
    .result { margin-top: 16px; font-weight: bold; text-align: center; font-size: 16px; }
    table { border-collapse: collapse; margin-top: 16px; width: 100%; font-size: 12px; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: center; }
    th { background: #eee; }
    @media (max-width: 480px) {
      table { font-size: 10px; }
      th, td { padding: 4px; }
    }
  </style>
</head>
<body>
  <h1>📦 貿易利潤判定器</h1>
  <p>請選擇每個城市的「買入」與「賣出」行情：</p>

  <div id="inputs"></div>

  <button onclick="calculate()">計算最優解</button>

  <div class="result" id="bestResult"></div>

  <h2 style="font-size:16px; margin-top:20px; text-align:center;">完整利潤表</h2>
  <div id="profitTable"></div>

  <script>
    const cities = ["泉州", "幽州", "杭州", "雙王", "十方"];
    const buyOptions = { "基礎": 1, "高價": 1.2 }; // 高價 = 1.2 倍成本
    const sellOptions = {
      "極低": 0.5,
      "基礎": 1.0,
      "略高": 2.0,
      "高價": 3.0,
      "極高": 4.0
    };

    const baseProfit = {
      "泉州": { "杭州": 12000, "幽州": 9000, "雙王": 9000 },
      "幽州": { "十方": 9190, "泉州": 8100 },
      "杭州": { "泉州": 12500, "幽州": 8083, "十方": 7166 },
      "雙王": { "十方": 6097, "幽州": 4609 },
      "十方": { "幽州": 7608, "雙王": 7608, "杭州": 2347 }
    };

    const container = document.getElementById("inputs");
    cities.forEach(city => {
      const div = document.createElement("div");
      div.classList.add("city-input");
      div.innerHTML = `<b>${city}</b>
        買入:
        <select id="${city}-buy">
          ${Object.keys(buyOptions).map(opt => `<option>${opt}</option>`).join("")}
        </select>
        賣出:
        <select id="${city}-sell">
          ${Object.keys(sellOptions).map(opt => `<option>${opt}</option>`).join("")}
        </select>`;
      container.appendChild(div);
    });

    function calculate() {
      let results = [];
      let best = { profit: -Infinity, route: "" };

      for (let from of cities) {
        for (let to of cities) {
          if (from === to) continue;
          if (!baseProfit[from] || !baseProfit[from][to]) continue;

          let buyType = document.getElementById(`${from}-buy`).value;
          let sellType = document.getElementById(`${to}-sell`).value;

          let base = baseProfit[from][to];
          let cost = base * buyOptions[buyType];
          let revenue = base * sellOptions[sellType];
          let profit = revenue - cost;

          results.push({ from, to, base, buyType, sellType, cost, revenue, profit });

          if (profit > best.profit) {
            best = { profit, route: `${from} → ${to} (${profit})` };
          }
        }
      }

      document.getElementById("bestResult").innerText = `最優解：${best.route}`;

      let html = "<table><tr><th>進貨</th><th>出貨</th><th>基準值</th><th>買入</th><th>賣出</th><th>成本</th><th>收入</th><th>利潤</th></tr>";
      results.forEach(r => {
        html += `<tr><td>${r.from}</td><td>${r.to}</td><td>${r.base}</td><td>${r.buyType}</td><td>${r.sellType}</td><td>${r.cost}</td><td>${r.revenue}</td><td>${r.profit}</td></tr>`;
      });
      html += "</table>";
      document.getElementById("profitTable").innerHTML = html;
    }
  </script>
</body>
</html>
